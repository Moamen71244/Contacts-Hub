let addBtn=document.getElementById("addBtn"),formInputs=document.getElementById("formInputs"),contactImageInput=document.getElementById("contactImageInput"),nameInput=document.getElementById("nameInput"),phoneNumberInput=document.getElementById("phoneNumberInput"),emailInput=document.getElementById("emailInput"),addressInput=document.getElementById("addressInput"),emergency=document.getElementById("emergency"),favorite=document.getElementById("favorite"),group=document.getElementById("group"),note=document.getElementById("note"),closeBtn=document.getElementById("closeBtn"),cancel=document.getElementById("cancel"),submetAdd=document.getElementById("save"),updateBtn=document.getElementById("update"),totalContacts=document.getElementById("totalContacts"),fsvoriteContacts=document.getElementById("fsvoriteContacts"),emergencyContacts=document.getElementById("emergencyContacts"),allContactsCards=document.getElementById("allContactsCards"),favContacts=document.getElementById("favContacts"),emyContacts=document.getElementById("emyContacts"),contactImage=document.getElementById("contactImage"),searchInput=document.getElementById("searchInput"),manageNum=document.getElementById("manageNum");var color="",hideImage="",hideLetter="",globalIndex=-1,ignoreIndex=-1,numOfFav=localStorage.getItem("numberOfFavContacts"),numOfEmy=localStorage.getItem("numberOfEmyContacts"),allContacts=[];function getDataFromTheForm(){return{image:contactImageInput.files[0]?.name,name:nameInput.value,phone:phoneNumberInput.value,email:emailInput.value,address:addressInput.value,emergency:emergency.checked,favorite:favorite.checked,note:note.value,group:group.value,gradient:randomGradient()}}function clearInputs(){nameInput.value="",phoneNumberInput.value="",emailInput.value="",addressInput.value="",emergency.checked=!1,favorite.checked=!1,group.value="",note.value="",contactImageInput.value=""}function display(){totalContacts.innerHTML=allContacts.length,addNewCard(""),addToFav(""),addToEmy(""),fsvoriteContacts.innerHTML=numOfFav,emergencyContacts.innerHTML=numOfEmy,manageNum.innerHTML=allContacts.length}function calcFSletters(e){var t=allContacts[e].name.trim().split(" ");return t.length>=2?t[0][0]+t[1][0]:t[0].slice(0,2)}function checkFav(e){return allContacts[e].favorite?" ":" d-none "}function checkEmy(e){return allContacts[e].emergency?" ":" d-none "}function checkUnFav(e){return allContacts[e].favorite?" d-none ":" "}function checkUnEmy(e){return allContacts[e].emergency?" d-none ":" "}function createCards(e){var t="";for(let a=0;a<e.length;a++)e[a].image?(hideImage=" ",hideLetter="d-none"):(hideImage="d-none",hideLetter=" "),t+=`        \n          <div class="card col-12 col-md-6 contact-card p-2 rounded-4 bg-transparent border-0">\n                    <div class="contact-details spechial-hover p-3 bg-white rounded-4">\n                <div class="d-flex align-items-center">\n                                <div id="userImage" class="avatar rounded-3 position-relative  flex-shrink-0 me-3" style="background-image: ${allContacts[a].gradient}">\n                        <img src="${e[a].image?"images/"+e[a].image:""}" class="w-100 ${hideImage} rounded-3" alt="">\n                        <p class="mb-0 ${hideLetter} ">${calcFSletters(a)}</p>\n    \n                        <span\n                            class="${checkFav(a)} position-absolute d-flex align-items-center justify-content-center fav-flag rounded-circle">\n                            <i class="fa-solid fa-star text-white"></i>\n                        </span>\n                        <span\n                            class="${checkEmy(a)} position-absolute d-flex align-items-center justify-content-center em-flag rounded-circle">\n                            <i class="fa-solid text-white fa-heart-pulse"></i>\n                        </span>\n                    </div>\n    \n                    <div class="user-details">\n                        <p class="name fw-bold mb-1 mb-0">${e[a].name}</p>\n                        <p class="phone d-flex align-items-center mb-1 text-secondary small ">\n                            \n                            <span class="rounded-3 user-d me-2"><i class="fa-solid fa-phone tel"></i></span>\n                            \n                            ${e[a].phone}\n                        </p>\n                    </div>\n                </div>\n                <div class="w-100 mt-2">\n                    <p class="email d-flex align-items-center mb-1 text-secondary small">\n                        <span class="rounded-3 user-d  me-2"><i class="fa-solid fa-envelope mail"></i></span>\n                        ${e[a].email}\n                    </p>\n                    <p class="location d-flex align-items-center mb-0 text-secondary small">\n                        <span class="rounded-3 user-d  me-2"><i class="fa-solid fa-location-dot mail"></i></span>\n                        ${e[a].address}\n    \n                    </p>\n                </div>\n    \n                <div class="tags-actions">\n                    <div class="tags my-2">\n                        <span class="tag tag-${e[a].group.toLocaleLowerCase()} me-2">${e[a].group}</span>\n                        <span class="tag tag-emergency ${checkEmy(a)}">Emergency</span>\n                    </div>\n                    <div class="actions pt-3 border-top d-flex align-items-center text-muted">\n                        <span  class=" rounded-3 user-d action-icon2 me-2"><a href="tel:${e[a].phone}"><i class="fa-solid fa-phone mail"></i></a></span>\n                        <span  class=" rounded-3 user-d action-icon1  me-2"><a href="mailto:moamenahmed0922@gmail.com"><i class="fa-solid fa-envelope mail"></i></a></span>\n                        <div  class=" ms-auto d-flex column-gap-3">\n                            <span class=" ${checkUnFav(a)} star-i"    onclick="toggleFav(${a})"  ><i class=" fa-regular fa-star action-icon"></i></span>\n                            <span class=" ${checkFav(a)} star-i-fav" onclick="toggleFav(${a})"  ><i class=" fa-solid fa-star action-icon" style="color: #FFD43B;"></i></span>\n                            <span class=" ${checkUnEmy(a)} heart-i"    onclick="toggleEmy(${a})"  ><i class=" fa-regular fa-heart action-icon"></i></span>\n                            <span class=" ${checkEmy(a)} heart-i-emy" onclick="toggleEmy(${a})"  ><i class=" fa-solid fa-heart-pulse" style="color: red;"></i></span>\n                            <span class="pen-i "     onclick="upDataToForm(${a})" ><i class=" fa-solid fa-pen action-icon"></i></span>\n                            <span class=" trash-i"    onclick="deleteContact(${a})" ><i class=" fa-solid fa-trash action-icon"></i></span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    \n    `;return t}function addNewCard(e){e=createCards(allContacts),allContactsCards.innerHTML=e}function addToFav(e){var t=0;for(let a=0;a<allContacts.length;a++)allContacts[a].image?(hideImage=" ",hideLetter="d-none"):(hideImage="d-none",hideLetter=" "),allContacts[a].favorite&&(t++,e+=`\n                    <div class="contact p-2 rounded-3 d-flex align-items-center">\n                                <div id="userImage" class="avatar rounded-3 position-relative  flex-shrink-0 me-3" style="background-image: ${allContacts[a].gradient}">\n                               <img src="${allContacts[a].image?"images/"+allContacts[a].image:""}" class="w-100 ${hideImage} rounded-3" alt="user">\n                               <p class="mb-0 ${hideLetter} ">${calcFSletters(a)}</p>\n                           </div>\n                        <div class="desc text-start">\n                            <p class="h7 fw-bold mb-0">${allContacts[a].name}</p>\n                            <p class="mb-0 fs-8 text-muted ">${allContacts[a].phone}</p>\n                        </div>\n                        <span  class="rounded-3 ratio-1x1 d-flex justify-content-center align-items-center action-icon2 fav-icon ms-auto"><a href="tel:${allContacts[a].phone}"><i class="fa-solid fa-phone mail"></i></a></span>\n                    </div>\n            `);favContacts.innerHTML=0===t?'<p class="text-muted m-0">No favorites Contacts</p>':e,numOfFav=t,localStorage.setItem("numberOfFavContacts",numOfFav)}function addToEmy(e){var t=0;for(let a=0;a<allContacts.length;a++)allContacts[a].image?(hideImage=" ",hideLetter="d-none"):(hideImage="d-none",hideLetter=" "),allContacts[a].emergency&&(t++,e+=`\n                    <div class="contact p-2 rounded-3 d-flex align-items-center">\n                                <div id="userImage" class="avatar rounded-3 position-relative  flex-shrink-0 me-3" style="background-image: ${allContacts[a].gradient}">\n                               <img src="${allContacts[a].image?"images/"+allContacts[a].image:""}" class="w-100 ${hideImage} rounded-3" alt="user">\n                               <p class="mb-0 ${hideLetter} ">${calcFSletters(a)}</p>\n                           </div>\n                        <div class="desc text-start">\n                            <p class="h7 fw-bold mb-0">${allContacts[a].name}</p>\n                            <p class="mb-0 fs-8 text-muted">${allContacts[a].phone}</p>\n                        </div>\n                        <span  class="rounded-3 ratio-1x1 d-flex justify-content-center align-items-center action-icon2 fav-icon ms-auto"><a href="tel:${allContacts[a].phone}"><i class="fa-solid fa-phone mail"></i></a></span>\n                    </div>\n            `);emyContacts.innerHTML=0===t?'<p class="text-muted m-0">No emergency Contacts</p>':e,numOfEmy=t,localStorage.setItem("numberOfEmyContacts",numOfEmy)}function toggleFav(e){allContacts[e].favorite=!allContacts[e].favorite,display(),localStorage.setItem("contactsList",JSON.stringify(allContacts))}function toggleEmy(e){allContacts[e].emergency=!allContacts[e].emergency,display(),localStorage.setItem("contactsList",JSON.stringify(allContacts))}function upDataToForm(e){allContacts[e].image?(hideImage=" ",hideLetter="d-none"):(hideImage="d-none",hideLetter=" "),contactImage.innerHTML=`\n                    <img src="${allContacts[e].image?"images/"+allContacts[e].image:""}" class="w-100 ${hideImage} rounded-circle" alt="">\n                    <p class="mb-0 ${hideLetter} text-white h2 ">${calcFSletters(e)}</p>\n    `,globalIndex=e,submetAdd.classList.add("d-none"),updateBtn.classList.remove("d-none"),formInputs.classList.remove("d-none"),nameInput.value=allContacts[e].name,phoneNumberInput.value=allContacts[e].phone,emailInput.value=allContacts[e].email,addressInput.value=allContacts[e].address,emergency.checked=allContacts[e].emergency,favorite.checked=allContacts[e].favorite,note.value=allContacts[e].note,group.value=allContacts[e].group}function deleteContact(e){Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((t=>{t.isConfirmed&&(allContacts.splice(e,1),localStorage.setItem("contactsList",JSON.stringify(allContacts)),Swal.fire({title:"Deleted!",text:"Your file has been deleted.",icon:"success"}),display())}))}function validationInputs(e,t){var a=e.value;return{nameInput:/^[A-Za-z ]{2,50}$/,phoneNumberInput:/^(\+?2)?(\+?20)?01[1250]{1}\d{8}$/,emailInput:/^[A-Za-z0-9._%+-]{3,30}@[A-Za-z0-9.-]{3,20}\.[A-Za-z]{2,10}$/}[e.id].test(a)?(e.classList.add("is-valid"),e.classList.remove("is-invalid"),document.getElementById(t).classList.add("d-none"),!0):(e.classList.remove("is-valid"),e.classList.add("is-invalid"),document.getElementById(t).classList.remove("d-none"),!1)}function checkDuplicate(e,t){for(let a=0;a<allContacts.length;a++)if(a!==t&&allContacts[a].phone===e)return a;return-1}localStorage.getItem("contactsList")&&(allContacts=JSON.parse(localStorage.getItem("contactsList")),display()),addBtn.addEventListener("click",(function(){formInputs.classList.remove("d-none"),contactImage.innerHTML=' <i class="fa-solid text-white fa-user display-5"></i>'})),cancel.addEventListener("click",(function(){formInputs.classList.add("d-none")})),closeBtn.addEventListener("click",(function(){formInputs.classList.add("d-none")})),submetAdd.addEventListener("click",(function(){if(validationInputs(nameInput,"nameAlert")&&validationInputs(emailInput,"emailAlert")&&validationInputs(phoneNumberInput,"phoneAlert")&&-1===checkDuplicate(phoneNumberInput.value,-1)){var e=getDataFromTheForm();allContacts.push(e),localStorage.setItem("contactsList",JSON.stringify(allContacts)),display(),clearInputs(),formInputs.classList.add("d-none"),nameInput.classList.remove("is-valid"),phoneNumberInput.classList.remove("is-valid"),emailInput.classList.remove("is-valid"),Swal.fire({title:"Good job!",text:"You clicked the button!",icon:"success"})}else validationInputs(nameInput,"nameAlert")?validationInputs(phoneNumberInput,"phoneAlert")?validationInputs(emailInput,"emailAlert")?Swal.fire({icon:"error",title:"Duplicate Phone Number",text:`A contact with this phone number already exists: ${allContacts[checkDuplicate(phoneNumberInput.value,-1)].name}`}):Swal.fire({icon:"error",title:"Invalid Email",text:"Please enter a valid email format."}):Swal.fire({icon:"error",title:"Invalid Phone Number",text:"Please enter a valid Egyptian phone number (e.g., 01018971244 or +201018971244)"}):Swal.fire({icon:"error",title:"Invalid Name",text:"Please enter a valid name (letters & spaces only, 2–50 characters)."});x=randomGradient()})),updateBtn.addEventListener("click",(function(){var e=getDataFromTheForm();validationInputs(nameInput,"nameAlert")&&validationInputs(emailInput,"emailAlert")&&validationInputs(phoneNumberInput,"phoneAlert")&&-1===checkDuplicate(phoneNumberInput.value,globalIndex)?(contactImageInput.files[0]||(e.image=allContacts[globalIndex].image),allContacts.splice(globalIndex,1,e),localStorage.setItem("contactsList",JSON.stringify(allContacts)),formInputs.classList.add("d-none"),clearInputs(),display(),updateBtn.classList.add("d-none"),submetAdd.classList.remove("d-none"),nameInput.classList.remove("is-valid"),phoneNumberInput.classList.remove("is-valid"),emailInput.classList.remove("is-valid"),Swal.fire({title:"Updated Successfully",text:"The contact has been updated.",icon:"success",confirmButtonText:"OK"})):validationInputs(nameInput,"nameAlert")?validationInputs(phoneNumberInput,"phoneAlert")?validationInputs(emailInput,"emailAlert")?Swal.fire({icon:"error",title:"Duplicate Phone Number",text:`A contact with this phone number already exists: ${allContacts[checkDuplicate(phoneNumberInput.value,-1)].name}`}):Swal.fire({icon:"error",title:"Invalid Email",text:"Please enter a valid email format."}):Swal.fire({icon:"error",title:"Invalid Phone Number",text:"Please enter a valid Egyptian phone number (e.g., 01018971244 or +201018971244)"}):Swal.fire({icon:"error",title:"Invalid Name",text:"Please enter a valid name (letters & spaces only, 2–50 characters)."})})),searchInput.addEventListener("input",(function(){var e=[];for(let t=0;t<allContacts.length;t++)(allContacts[t].name.toLocaleLowerCase().includes(searchInput.value.toLocaleLowerCase())||" "===searchInput.value||allContacts[t].email.toLocaleLowerCase().includes(searchInput.value.toLocaleLowerCase())||allContacts[t].phone.toLocaleLowerCase().includes(searchInput.value.toLocaleLowerCase()))&&e.push(allContacts[t]);console.log(e),allContactsCards.innerHTML=createCards(e)}));const gradientColors=[["#ff9800","#ffaa2c"],["#642fde","#3900bf"],["#ee058d","#ee058d"],["#7501c2","#a73cee"]];function randomGradient(){let e=gradientColors[Math.floor(Math.random()*gradientColors.length)];return`linear-gradient(135deg, ${e[0]}, ${e[1]})`}
